import { ADMIN_COOKIE } from '@/lib/constant';
import { Link } from '@tanstack/react-router';
import Cookies from 'js-cookie';
import { ChevronRight, Menu } from 'lucide-react';
import { useState } from 'react';
import useMediaQuery from '../../../hooks/useMediaQuery';
import usePaths from '../../../hooks/usePaths';
import { Avatar, AvatarFallback, AvatarImage } from '../../ui/avatar';
import { Button } from '../../ui/button';
import { Separator } from '../../ui/separator';
import { Sheet, SheetContent, SheetTrigger } from '../../ui/sheet';
import Sidebar from '../Sidebar';

const Index = () => {
  const [isSidebar, setIsSidebar] = useState(false);
  const isMobile = useMediaQuery('(min-width: 767px)');
  const user = Cookies.get(ADMIN_COOKIE);

  const path = usePaths();

  return (
    <>
      <header className='min-h-[90px] px-6 flex items-center justify-between dark:bg-black'>
        <div className='flex items-center gap-x-4'>
          <Sheet open={!isMobile && isSidebar} onOpenChange={e => setIsSidebar(e)}>
            <SheetTrigger asChild>
              <Button className='p-2 md:hidden'>
                <Menu />
              </Button>
            </SheetTrigger>
            <SheetContent className='w-max p-0 border-0 flex flex-col gap-0 overflow-hidden dark:bg-black' side='left'>
              <Sidebar mobile />
            </SheetContent>
          </Sheet>

          <div className='flex items-center gap-x-2'>
            {path.previousPaths && path.previousPaths.length
              ? path.previousPaths.map((path, index) => {
                  return (
                    <div key={index} className='flex items-center gap-x-2'>
                      <Link
                        to={path.path}
                        search={{ ...(path.search ? { ...path.search } : {}) }}
                        className='font-semibold text-2xl border-b border-transparent dark:text-input_text dark:hover:text-white dark:hover:border-b-white transition-all'>
                        {path.name}
                      </Link>
                      <ChevronRight className='size-6 dark:text-input_text' />
                    </div>
                  );
                })
              : null}
            <h4 className='font-semibold text-2xl dark:text-[#F5F5F5] transition-all'>{path.name}</h4>
          </div>
        </div>
        <div className='py-2 px-3 rounded-xl flex items-center gap-x-3 dark:bg-[#161616]'>
          <Avatar className='size-10'>
            <AvatarImage className='object-cover object-[25%_30%]' src={JSON.parse(user).profile} />
            <AvatarFallback className='bg-white'>
              <svg className='w-full h-full' viewBox='0 0 35 35' fill='none' xmlns='http://www.w3.org/2000/svg'>
                <path
                  d='M11.0728 9.84383C11.0728 6.29914 13.9551 3.41675 17.4998 3.41675C21.0442 3.41675 23.9264 6.29862 23.9269 9.84287C23.9129 13.3203 21.1979 16.1302 17.7388 16.2563H17.7388H17.7387H17.7387H17.7386H17.7386H17.7385H17.7385H17.7384H17.7384H17.7383H17.7383H17.7382H17.7382H17.7381H17.7381H17.738H17.738H17.7379H17.7379H17.7378H17.7378H17.7377H17.7377H17.7376H17.7376H17.7375H17.7375H17.7374H17.7374H17.7373H17.7373H17.7372H17.7372H17.7371H17.7371H17.737H17.737H17.7369H17.7369H17.7368H17.7368H17.7367H17.7367H17.7367H17.7366H17.7366H17.7365H17.7365H17.7364H17.7364H17.7363H17.7363H17.7362H17.7362H17.7361H17.7361H17.7361H17.736H17.736H17.7359H17.7359H17.7358H17.7358H17.7357H17.7357H17.7356H17.7356H17.7356H17.7355H17.7355H17.7354H17.7354H17.7353H17.7353H17.7352H17.7352H17.7352H17.7351H17.7351H17.735H17.735H17.7349H17.7349H17.7348H17.7348H17.7348H17.7347H17.7347H17.7346H17.7346H17.7345H17.7345H17.7345H17.7344H17.7344H17.7343H17.7343H17.7342H17.7342H17.7342H17.7341H17.7341H17.734H17.734H17.7339H17.7339H17.7339H17.7338H17.7338H17.7337H17.7337H17.7336H17.7336H17.7336H17.7335H17.7335H17.7334H17.7334H17.7333H17.7333H17.7333H17.7332H17.7332H17.7331H17.7331H17.733H17.733H17.733H17.7329H17.7329H17.7328H17.7328H17.7327H17.7327H17.7327H17.7326H17.7326H17.7325H17.7325H17.7324H17.7324H17.7324H17.7323H17.7323H17.7322H17.7322H17.7321H17.7321H17.7321H17.732H17.732H17.7319H17.7319H17.7318H17.7318H17.7318H17.7317H17.7317H17.7316H17.7316H17.7315H17.7315H17.7314H17.7314H17.7314H17.7313H17.7313H17.7312H17.7312H17.7311H17.7311H17.7311H17.731H17.731H17.7309H17.7309H17.7308H17.7308H17.7307H17.7307H17.7306H17.7306H17.7306H17.7305H17.7305H17.7304H17.7304H17.7303H17.7303H17.7302H17.7302H17.7302H17.7301H17.7301H17.73H17.73H17.7299H17.7299H17.7298H17.7298H17.7297H17.7297H17.7296H17.7296H17.7295H17.7295H17.7295H17.7294H17.7294H17.7293H17.7293H17.7292H17.7292H17.7291H17.7291H17.729H17.729H17.7289H17.7289H17.7288H17.7288H17.7287H17.7287H17.7286H17.7286H17.7285H17.7285H17.7284H17.7284H17.7283H17.7283H17.7282H17.7282H17.7281H17.7281H17.728H17.728H17.7279H17.7279H17.7278H17.7278H17.7277H17.7277H17.7276H17.7276H17.7275H17.7275H17.7274H17.7274H17.7273H17.7272H17.7272H17.7271H17.7271H17.727H17.727H17.7269H17.7269H17.7268H17.7268H17.7267H17.7266H17.7266H17.7265H17.7265H17.7264H17.7264H17.7263H17.7263H17.7262H17.7261H17.7261H17.726H17.726H17.7259H17.7259H17.7258H17.7257H17.7257H17.7256H17.7256H17.7255H17.7254H17.7254H17.7253H17.7253H17.7252H17.7251H17.7251H17.725H17.725H17.7249H17.7248H17.7248H17.7247H17.7247H17.7246H17.7245H17.7245H17.7244H17.7243H17.7243H17.7242H17.7241H17.7241H17.724H17.724H17.7239H17.7238H17.7238H17.7237H17.7236H17.7236H17.7235H17.7234H17.7234H17.7233H17.7232H17.7232H17.7231H17.723H17.723H17.7229H17.7228H17.7227H17.7227H17.7226H17.7225H17.7225H17.7224H17.7223H17.7223H17.7222H17.7221H17.722H17.722H17.7219H17.7218H17.7218H17.7217H17.7216H17.7215H17.7215H17.7214H17.7213H17.7212H17.7212H17.7211H17.721H17.7209H17.7209H17.7208H17.7207H17.7206H17.7205H17.7205H17.7204H17.7203H17.7202H17.7202H17.7201H17.72H17.7199H17.7198H17.7198H17.7197H17.7196H17.7195H17.7194H17.7193H17.7193H17.7192H17.7191H17.719H17.7189H17.7188H17.7188H17.7187H17.7186H17.7184H17.7182H17.7181H17.7179H17.7177H17.7176H17.7174H17.7172H17.7171H17.7169H17.7167H17.7166H17.7164H17.7162H17.7161H17.7159H17.7157H17.7156H17.7154H17.7152H17.7151H17.7149H17.7147H17.7146H17.7144H17.7143H17.7141H17.7139H17.7138H17.7136H17.7134H17.7133H17.7131H17.713H17.7128H17.7126H17.7125H17.7123H17.7122H17.712H17.7118H17.7117H17.7115H17.7114H17.7112H17.7111H17.7109H17.7107H17.7106H17.7104H17.7103H17.7101H17.71H17.7098H17.7097H17.7095H17.7093H17.7092H17.709H17.7089H17.7087H17.7086H17.7084H17.7083H17.7081H17.708H17.7078H17.7077H17.7075H17.7074H17.7072H17.7071H17.7069H17.7068H17.7066H17.7065H17.7063H17.7062H17.706H17.7059H17.7057H17.7056H17.7054H17.7053H17.7051H17.705H17.7048H17.7047H17.7045H17.7044H17.7043H17.7041H17.704H17.7038H17.7037H17.7035H17.7034H17.7032H17.7031H17.7029H17.7028H17.7027H17.7025H17.7024H17.7022H17.7021H17.7019H17.7018H17.7017H17.7015H17.7014H17.7012H17.7011H17.701H17.7008H17.7007H17.7005H17.7004H17.7002H17.7001H17.7H17.6998H17.6997H17.6995H17.6994H17.6993H17.6991H17.699H17.6989H17.6987H17.6986H17.6984H17.6983H17.6982H17.698H17.6979H17.6977H17.6976H17.6975H17.6973H17.6972H17.6971H17.6969H17.6968H17.6967H17.6965H17.6964H17.6962H17.6961H17.696H17.6958H17.6957H17.6956H17.6954H17.6953H17.6952H17.695H17.6949H17.6948H17.6946H17.6945H17.6944H17.6942H17.6941H17.694H17.6938H17.6937H17.6936H17.6934H17.6933H17.6932H17.693H17.6929H17.6928H17.6926H17.6925H17.6924H17.6922H17.6921H17.692H17.6918H17.6917H17.6916H17.6914H17.6913H17.6912H17.691H17.6909H17.6908H17.6907H17.6905H17.6904H17.6903H17.6901H17.69H17.6899H17.6897H17.6896H17.6895H17.6893H17.6892H17.6891H17.689H17.6888H17.6887H17.6886H17.6884H17.6883H17.6882H17.688H17.6879H17.6878H17.6877H17.6875H17.6874H17.6873H17.6871H17.687H17.6869H17.6868H17.6866H17.6865H17.6864H17.6862H17.6861H17.686H17.6859H17.6857H17.6856H17.6855H17.6853H17.6852H17.6851H17.685H17.6848H17.6847H17.6846H17.6844H17.6843H17.6842H17.6841H17.6839H17.6838H17.6837H17.6835H17.6834H17.6833H17.6832H17.683H17.6829H17.6828H17.6826H17.6825H17.6824H17.6823H17.6821H17.682H17.6819H17.6817H17.6816H17.6815H17.6814H17.6812H17.6812C17.5599 16.2411 17.4285 16.2428 17.3059 16.2553C13.7686 16.1154 11.0728 13.307 11.0728 9.84383Z'
                  fill='#707573'
                  stroke='#707573'
                />
                <path
                  d='M10.3705 29.612L10.3691 29.6111C8.63263 28.4535 7.7334 26.9314 7.7334 25.3459C7.7334 23.76 8.63298 22.2236 10.3834 21.0517C12.3339 19.761 14.9154 19.1011 17.5183 19.1011C20.1218 19.1011 22.6957 19.7613 24.6311 21.0515C26.3639 22.2067 27.253 23.7285 27.2667 25.3187C27.266 26.9184 26.3664 28.4402 24.6294 29.6122C22.6869 30.9164 20.1062 31.5834 17.5001 31.5834C14.8938 31.5834 12.313 30.9163 10.3705 29.612Z'
                  fill='#707573'
                  stroke='#707573'
                />
              </svg>
            </AvatarFallback>
          </Avatar>
          <p className='text-base dark:text-[#F5F5F5] font-medium'>{JSON.parse(user).name ?? 'Admin'}</p>
        </div>
      </header>
      <Separator orientation='horizontal' className='h-[1px] w-[calc(100%-48px)] mx-auto dark:bg-[#231E28]' />
    </>
  );
};

export default Index;
